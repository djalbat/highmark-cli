"use strict";
Object.defineProperty(exports, "__esModule", {
    value: true
});
Object.defineProperty(exports, "default", {
    enumerable: true,
    get: function() {
        return createIndexHTMLOperation;
    }
});
var _highmarkmarkdown = require("highmark-markdown");
var _livelycli = require("lively-cli");
var _necessary = require("necessary");
var _highmarkclient = require("highmark-client");
var _fileSystem = require("../utilities/fileSystem");
var _constants = require("../constants");
var parseContent = _necessary.templateUtilities.parseContent, concatenatePaths = _necessary.pathUtilities.concatenatePaths;
function createIndexHTMLOperation(proceed, abort, context) {
    var client = context.client, highmarkCSS = context.highmarkCSS, highmarkHTML = context.highmarkHTML, projectDirectoryName = context.projectDirectoryName, liveReloadHTML = _livelycli.liveReloadSnippet, fontCSS = _highmarkmarkdown.fontStyle, args = {
        fontCSS: fontCSS,
        highmarkCSS: highmarkCSS,
        highmarkHTML: highmarkHTML,
        liveReloadHTML: liveReloadHTML
    };
    if (client) {
        Object.assign(args, {
            clientHTML: _highmarkclient.clientHTML,
            loadingDivCSS: _highmarkclient.loadingDivCSS,
            loadingDivHTML: _highmarkclient.loadingDivHTML,
            notLoadingDivCSS: _highmarkclient.notLoadingDivCSS
        });
    }
    var content;
    content = _highmarkclient.indexHTML; ///
    var regularExpression = /{(.+?)}/g, parsedContent = parseContent(content, args, regularExpression);
    content = parsedContent; ///
    var filePath = concatenatePaths(projectDirectoryName, _constants.INDEX_HTML_FILE_NAME);
    (0, _fileSystem.writeFile)(filePath, content);
    proceed();
}

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy9vcGVyYXRpb24vY3JlYXRlSW5kZXhIVE1MLmpzIl0sInNvdXJjZXNDb250ZW50IjpbIlwidXNlIHN0cmljdFwiO1xuXG5pbXBvcnQgeyBmb250U3R5bGUgfSBmcm9tIFwiaGlnaG1hcmstbWFya2Rvd25cIjtcbmltcG9ydCB7IGxpdmVSZWxvYWRTbmlwcGV0IH0gZnJvbSBcImxpdmVseS1jbGlcIjtcbmltcG9ydCB7IHBhdGhVdGlsaXRpZXMsIHRlbXBsYXRlVXRpbGl0aWVzIH0gZnJvbSBcIm5lY2Vzc2FyeVwiO1xuaW1wb3J0IHsgaW5kZXhIVE1MLCBjbGllbnRIVE1MLCBsb2FkaW5nRGl2SFRNTCwgbG9hZGluZ0RpdkNTUywgbm90TG9hZGluZ0RpdkNTUyB9IGZyb20gXCJoaWdobWFyay1jbGllbnRcIlxuXG5pbXBvcnQgeyB3cml0ZUZpbGUgfSBmcm9tIFwiLi4vdXRpbGl0aWVzL2ZpbGVTeXN0ZW1cIjtcbmltcG9ydCB7IElOREVYX0hUTUxfRklMRV9OQU1FIH0gZnJvbSBcIi4uL2NvbnN0YW50c1wiO1xuXG5jb25zdCB7IHBhcnNlQ29udGVudCB9ID0gdGVtcGxhdGVVdGlsaXRpZXMsXG4gICAgICB7IGNvbmNhdGVuYXRlUGF0aHMgfSA9IHBhdGhVdGlsaXRpZXM7XG5cbmV4cG9ydCBkZWZhdWx0IGZ1bmN0aW9uIGNyZWF0ZUluZGV4SFRNTE9wZXJhdGlvbihwcm9jZWVkLCBhYm9ydCwgY29udGV4dCkge1xuICBjb25zdCB7IGNsaWVudCwgaGlnaG1hcmtDU1MsIGhpZ2htYXJrSFRNTCwgcHJvamVjdERpcmVjdG9yeU5hbWUgfSA9IGNvbnRleHQsXG4gICAgICAgIGxpdmVSZWxvYWRIVE1MID0gbGl2ZVJlbG9hZFNuaXBwZXQsIC8vL1xuICAgICAgICBmb250Q1NTID0gZm9udFN0eWxlLCAgLy8vXG4gICAgICAgIGFyZ3MgPSB7XG4gICAgICAgICAgZm9udENTUyxcbiAgICAgICAgICBoaWdobWFya0NTUyxcbiAgICAgICAgICBoaWdobWFya0hUTUwsXG4gICAgICAgICAgbGl2ZVJlbG9hZEhUTUxcbiAgICAgICAgfTtcblxuICBpZiAoY2xpZW50KSB7XG4gICAgT2JqZWN0LmFzc2lnbihhcmdzLCB7XG4gICAgICBjbGllbnRIVE1MLFxuICAgICAgbG9hZGluZ0RpdkNTUyxcbiAgICAgIGxvYWRpbmdEaXZIVE1MLFxuICAgICAgbm90TG9hZGluZ0RpdkNTU1xuICAgIH0pO1xuICB9XG5cbiAgbGV0IGNvbnRlbnQ7XG5cbiAgY29udGVudCA9IGluZGV4SFRNTDsgIC8vL1xuXG4gIGNvbnN0IHJlZ3VsYXJFeHByZXNzaW9uID0gL3soLis/KX0vZyxcbiAgICAgICAgcGFyc2VkQ29udGVudCA9IHBhcnNlQ29udGVudChjb250ZW50LCBhcmdzLCByZWd1bGFyRXhwcmVzc2lvbik7XG5cbiAgY29udGVudCA9IHBhcnNlZENvbnRlbnQ7ICAvLy9cblxuICBjb25zdCBmaWxlUGF0aCA9IGNvbmNhdGVuYXRlUGF0aHMocHJvamVjdERpcmVjdG9yeU5hbWUsIElOREVYX0hUTUxfRklMRV9OQU1FKTtcblxuICB3cml0ZUZpbGUoZmlsZVBhdGgsIGNvbnRlbnQpO1xuXG4gIHByb2NlZWQoKTtcbn1cbiJdLCJuYW1lcyI6WyJjcmVhdGVJbmRleEhUTUxPcGVyYXRpb24iLCJwYXJzZUNvbnRlbnQiLCJ0ZW1wbGF0ZVV0aWxpdGllcyIsImNvbmNhdGVuYXRlUGF0aHMiLCJwYXRoVXRpbGl0aWVzIiwicHJvY2VlZCIsImFib3J0IiwiY29udGV4dCIsImNsaWVudCIsImhpZ2htYXJrQ1NTIiwiaGlnaG1hcmtIVE1MIiwicHJvamVjdERpcmVjdG9yeU5hbWUiLCJsaXZlUmVsb2FkSFRNTCIsImxpdmVSZWxvYWRTbmlwcGV0IiwiZm9udENTUyIsImZvbnRTdHlsZSIsImFyZ3MiLCJPYmplY3QiLCJhc3NpZ24iLCJjbGllbnRIVE1MIiwibG9hZGluZ0RpdkNTUyIsImxvYWRpbmdEaXZIVE1MIiwibm90TG9hZGluZ0RpdkNTUyIsImNvbnRlbnQiLCJpbmRleEhUTUwiLCJyZWd1bGFyRXhwcmVzc2lvbiIsInBhcnNlZENvbnRlbnQiLCJmaWxlUGF0aCIsIklOREVYX0hUTUxfRklMRV9OQU1FIiwid3JpdGVGaWxlIl0sIm1hcHBpbmdzIjoiQUFBQTs7OzsrQkFhQTs7O2VBQXdCQTs7O2dDQVhFO3lCQUNRO3lCQUNlOzhCQUNzQzswQkFFN0Q7eUJBQ1c7QUFFckMsSUFBTSxBQUFFQyxlQUFpQkMsNEJBQWlCLENBQWxDRCxjQUNGLEFBQUVFLG1CQUFxQkMsd0JBQWEsQ0FBbENEO0FBRU8sU0FBU0gseUJBQXlCSyxPQUFPLEVBQUVDLEtBQUssRUFBRUMsT0FBTztJQUN0RSxJQUFRQyxTQUE0REQsUUFBNURDLFFBQVFDLGNBQW9ERixRQUFwREUsYUFBYUMsZUFBdUNILFFBQXZDRyxjQUFjQyx1QkFBeUJKLFFBQXpCSSxzQkFDckNDLGlCQUFpQkMsNEJBQWlCLEVBQ2xDQyxVQUFVQywyQkFBUyxFQUNuQkMsT0FBTztRQUNMRixTQUFBQTtRQUNBTCxhQUFBQTtRQUNBQyxjQUFBQTtRQUNBRSxnQkFBQUE7SUFDRjtJQUVOLElBQUlKLFFBQVE7UUFDVlMsT0FBT0MsTUFBTSxDQUFDRixNQUFNO1lBQ2xCRyxZQUFBQSwwQkFBVTtZQUNWQyxlQUFBQSw2QkFBYTtZQUNiQyxnQkFBQUEsOEJBQWM7WUFDZEMsa0JBQUFBLGdDQUFnQjtRQUNsQjtJQUNGO0lBRUEsSUFBSUM7SUFFSkEsVUFBVUMseUJBQVMsRUFBRyxHQUFHO0lBRXpCLElBQU1DLG9CQUFvQixZQUNwQkMsZ0JBQWdCekIsYUFBYXNCLFNBQVNQLE1BQU1TO0lBRWxERixVQUFVRyxlQUFnQixHQUFHO0lBRTdCLElBQU1DLFdBQVd4QixpQkFBaUJRLHNCQUFzQmlCLCtCQUFvQjtJQUU1RUMsSUFBQUEscUJBQVMsRUFBQ0YsVUFBVUo7SUFFcEJsQjtBQUNGIn0=