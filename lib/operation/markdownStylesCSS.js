"use strict";
Object.defineProperty(exports, "__esModule", {
    value: true
});
Object.defineProperty(exports, "default", {
    enumerable: true,
    get: function() {
        return markdownStylesCSSOperation;
    }
});
var _highmarkclient = require("highmark-client");
var _highmarkmarkdown = require("highmark-markdown");
var _division = require("../utilities/division");
var _fileSystem = require("../utilities/fileSystem");
var _constants = require("../constants");
var _filePath = require("../utilities/filePath");
var CLIENT_DIVS_CSS_SELECTORS_STRING = _highmarkclient.constants.DIVS_CSS_SELECTORS_STRING, cssFromMarkdownStyleAndCSSSelectorsString = _highmarkmarkdown.grammarUtilities.cssFromMarkdownStyleAndCSSSelectorsString;
function markdownStylesCSSOperation(proceed, abort, context) {
    var client = context.client, projectDirectoryName = context.projectDirectoryName, projectDirectoryPath = projectDirectoryName, markdownStyleFilePaths = [];
    (0, _fileSystem.readDirectory)(projectDirectoryPath, function(filePath) {
        var filePathMarkdownStyleFilePath = (0, _filePath.isFilePathMarkdownStyleFilePath)(filePath);
        if (filePathMarkdownStyleFilePath) {
            var markdownStyleFilePath = filePath, filePathDefaultMarkdownStyleFilePath = (0, _filePath.isFilePathDefaultMarkdownStyleFilePath)(filePath);
            filePathDefaultMarkdownStyleFilePath ? markdownStyleFilePaths.unshift(markdownStyleFilePath) : markdownStyleFilePaths.push(markdownStyleFilePath);
        }
    });
    var cssSelectorString = client ? CLIENT_DIVS_CSS_SELECTORS_STRING : _constants.DIVS_CSS_SELECTORS_STRING, markdownStyle = _highmarkmarkdown.defaultMarkdownStyle, css = cssFromMarkdownStyleAndCSSSelectorsString(markdownStyle, cssSelectorString);
    var markdownStylesCSS = css; ///
    markdownStyleFilePaths.forEach(function(markdownStyleFilePath) {
        var selectorString = selectorStringFromMarkdownStyleFilePathAndClient(markdownStyleFilePath, client), markdownStyle = markdownStyleFromMarkdownStyleFilePath(markdownStyleFilePath), css = cssFromMarkdownStyleAndSelectorString(markdownStyle, selectorString, markdownStylesCSS); ///
        markdownStylesCSS = "".concat(markdownStylesCSS).concat(css);
    });
    Object.assign(context, {
        markdownStylesCSS: markdownStylesCSS
    });
    proceed();
}
function markdownStyleFromMarkdownStyleFilePath(markdownStyleFilePath) {
    var filePath = markdownStyleFilePath, content = (0, _fileSystem.readFile)(filePath), markdownStyle = content; ///
    return markdownStyle;
}
function selectorStringFromMarkdownStyleFilePathAndClient(markdownStyleFilePath, client) {
    var selectorString = client ? CLIENT_DIVS_CSS_SELECTORS_STRING : _constants.DIVS_CSS_SELECTORS_STRING;
    var filePath = markdownStyleFilePath, className = (0, _division.classNameFromFilePath)(filePath);
    if (className !== null) {
        selectorString = "".concat(selectorString, ".").concat(className);
    }
    return selectorString;
}

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy9vcGVyYXRpb24vbWFya2Rvd25TdHlsZXNDU1MuanMiXSwic291cmNlc0NvbnRlbnQiOlsiXCJ1c2Ugc3RyaWN0XCI7XG5cbmltcG9ydCB7IGNvbnN0YW50cyB9IGZyb20gXCJoaWdobWFyay1jbGllbnRcIjtcbmltcG9ydCB7IGdyYW1tYXJVdGlsaXRpZXMsIGRlZmF1bHRNYXJrZG93blN0eWxlIH0gZnJvbSBcImhpZ2htYXJrLW1hcmtkb3duXCI7XG5cbmltcG9ydCB7IGNsYXNzTmFtZUZyb21GaWxlUGF0aCB9IGZyb20gXCIuLi91dGlsaXRpZXMvZGl2aXNpb25cIjtcbmltcG9ydCB7IHJlYWRGaWxlLCByZWFkRGlyZWN0b3J5IH0gZnJvbSBcIi4uL3V0aWxpdGllcy9maWxlU3lzdGVtXCI7XG5pbXBvcnQgeyBESVZTX0NTU19TRUxFQ1RPUlNfU1RSSU5HIH0gZnJvbSBcIi4uL2NvbnN0YW50c1wiO1xuaW1wb3J0IHsgaXNGaWxlUGF0aE1hcmtkb3duU3R5bGVGaWxlUGF0aCwgaXNGaWxlUGF0aERlZmF1bHRNYXJrZG93blN0eWxlRmlsZVBhdGggfSBmcm9tIFwiLi4vdXRpbGl0aWVzL2ZpbGVQYXRoXCI7XG5cbmNvbnN0IHsgRElWU19DU1NfU0VMRUNUT1JTX1NUUklORzogQ0xJRU5UX0RJVlNfQ1NTX1NFTEVDVE9SU19TVFJJTkcgfSA9IGNvbnN0YW50cyxcbiAgICAgIHsgY3NzRnJvbU1hcmtkb3duU3R5bGVBbmRDU1NTZWxlY3RvcnNTdHJpbmcgfSA9IGdyYW1tYXJVdGlsaXRpZXM7XG5cbmV4cG9ydCBkZWZhdWx0IGZ1bmN0aW9uIG1hcmtkb3duU3R5bGVzQ1NTT3BlcmF0aW9uKHByb2NlZWQsIGFib3J0LCBjb250ZXh0KSB7XG4gIGNvbnN0IHsgY2xpZW50LCBwcm9qZWN0RGlyZWN0b3J5TmFtZSB9ID0gY29udGV4dCxcbiAgICAgICAgcHJvamVjdERpcmVjdG9yeVBhdGggPSBwcm9qZWN0RGlyZWN0b3J5TmFtZSwgIC8vL1xuICAgICAgICBtYXJrZG93blN0eWxlRmlsZVBhdGhzID0gW107XG5cbiAgcmVhZERpcmVjdG9yeShwcm9qZWN0RGlyZWN0b3J5UGF0aCwgKGZpbGVQYXRoKSA9PiB7XG4gICAgY29uc3QgZmlsZVBhdGhNYXJrZG93blN0eWxlRmlsZVBhdGggPSBpc0ZpbGVQYXRoTWFya2Rvd25TdHlsZUZpbGVQYXRoKGZpbGVQYXRoKTtcblxuICAgIGlmIChmaWxlUGF0aE1hcmtkb3duU3R5bGVGaWxlUGF0aCkge1xuICAgICAgY29uc3QgbWFya2Rvd25TdHlsZUZpbGVQYXRoID0gZmlsZVBhdGgsXG4gICAgICAgICAgICBmaWxlUGF0aERlZmF1bHRNYXJrZG93blN0eWxlRmlsZVBhdGggPSBpc0ZpbGVQYXRoRGVmYXVsdE1hcmtkb3duU3R5bGVGaWxlUGF0aChmaWxlUGF0aCk7XG5cbiAgICAgIGZpbGVQYXRoRGVmYXVsdE1hcmtkb3duU3R5bGVGaWxlUGF0aCA/XG4gICAgICAgIG1hcmtkb3duU3R5bGVGaWxlUGF0aHMudW5zaGlmdChtYXJrZG93blN0eWxlRmlsZVBhdGgpIDpcbiAgICAgICAgICBtYXJrZG93blN0eWxlRmlsZVBhdGhzLnB1c2gobWFya2Rvd25TdHlsZUZpbGVQYXRoKTtcbiAgICB9XG4gIH0pO1xuXG4gIGNvbnN0IGNzc1NlbGVjdG9yU3RyaW5nID0gY2xpZW50ID9cbiAgICAgICAgICAgICAgICAgICAgICAgICAgIENMSUVOVF9ESVZTX0NTU19TRUxFQ1RPUlNfU1RSSU5HIDpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgRElWU19DU1NfU0VMRUNUT1JTX1NUUklORyxcbiAgICAgICAgbWFya2Rvd25TdHlsZSA9IGRlZmF1bHRNYXJrZG93blN0eWxlLCAvLy9cbiAgICAgICAgY3NzID0gY3NzRnJvbU1hcmtkb3duU3R5bGVBbmRDU1NTZWxlY3RvcnNTdHJpbmcobWFya2Rvd25TdHlsZSwgY3NzU2VsZWN0b3JTdHJpbmcpO1xuXG4gIGxldCBtYXJrZG93blN0eWxlc0NTUyA9IGNzczsgLy8vXG5cbiAgbWFya2Rvd25TdHlsZUZpbGVQYXRocy5mb3JFYWNoKChtYXJrZG93blN0eWxlRmlsZVBhdGgpID0+IHtcbiAgICBjb25zdCBzZWxlY3RvclN0cmluZyA9IHNlbGVjdG9yU3RyaW5nRnJvbU1hcmtkb3duU3R5bGVGaWxlUGF0aEFuZENsaWVudChtYXJrZG93blN0eWxlRmlsZVBhdGgsIGNsaWVudCksXG4gICAgICAgICAgbWFya2Rvd25TdHlsZSA9IG1hcmtkb3duU3R5bGVGcm9tTWFya2Rvd25TdHlsZUZpbGVQYXRoKG1hcmtkb3duU3R5bGVGaWxlUGF0aCksXG4gICAgICAgICAgY3NzID0gY3NzRnJvbU1hcmtkb3duU3R5bGVBbmRTZWxlY3RvclN0cmluZyhtYXJrZG93blN0eWxlLCBzZWxlY3RvclN0cmluZywgbWFya2Rvd25TdHlsZXNDU1MpOyAgLy8vXG5cbiAgICBtYXJrZG93blN0eWxlc0NTUyA9IGAke21hcmtkb3duU3R5bGVzQ1NTfSR7Y3NzfWA7XG4gIH0pO1xuXG4gIE9iamVjdC5hc3NpZ24oY29udGV4dCwge1xuICAgIG1hcmtkb3duU3R5bGVzQ1NTXG4gIH0pO1xuXG4gIHByb2NlZWQoKTtcbn1cblxuZnVuY3Rpb24gbWFya2Rvd25TdHlsZUZyb21NYXJrZG93blN0eWxlRmlsZVBhdGgobWFya2Rvd25TdHlsZUZpbGVQYXRoKSB7XG4gIGNvbnN0IGZpbGVQYXRoID0gbWFya2Rvd25TdHlsZUZpbGVQYXRoLCAvLy9cbiAgICAgICAgY29udGVudCA9IHJlYWRGaWxlKGZpbGVQYXRoKSxcbiAgICAgICAgbWFya2Rvd25TdHlsZSA9IGNvbnRlbnQ7ICAvLy9cblxuICByZXR1cm4gbWFya2Rvd25TdHlsZTtcbn1cblxuZnVuY3Rpb24gc2VsZWN0b3JTdHJpbmdGcm9tTWFya2Rvd25TdHlsZUZpbGVQYXRoQW5kQ2xpZW50KG1hcmtkb3duU3R5bGVGaWxlUGF0aCwgY2xpZW50KSB7XG4gIGxldCBzZWxlY3RvclN0cmluZyA9IGNsaWVudCA/XG4gICAgICAgICAgICAgICAgICAgICAgICAgQ0xJRU5UX0RJVlNfQ1NTX1NFTEVDVE9SU19TVFJJTkcgOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgRElWU19DU1NfU0VMRUNUT1JTX1NUUklORztcblxuICBjb25zdCBmaWxlUGF0aCA9IG1hcmtkb3duU3R5bGVGaWxlUGF0aCwgIC8vL1xuICAgICAgICBjbGFzc05hbWUgPSBjbGFzc05hbWVGcm9tRmlsZVBhdGgoZmlsZVBhdGgpO1xuXG4gIGlmIChjbGFzc05hbWUgIT09IG51bGwpIHtcbiAgICBzZWxlY3RvclN0cmluZyA9IGAke3NlbGVjdG9yU3RyaW5nfS4ke2NsYXNzTmFtZX1gO1xuICB9XG5cbiAgcmV0dXJuIHNlbGVjdG9yU3RyaW5nO1xufVxuIl0sIm5hbWVzIjpbIm1hcmtkb3duU3R5bGVzQ1NTT3BlcmF0aW9uIiwiRElWU19DU1NfU0VMRUNUT1JTX1NUUklORyIsIkNMSUVOVF9ESVZTX0NTU19TRUxFQ1RPUlNfU1RSSU5HIiwiY29uc3RhbnRzIiwiY3NzRnJvbU1hcmtkb3duU3R5bGVBbmRDU1NTZWxlY3RvcnNTdHJpbmciLCJncmFtbWFyVXRpbGl0aWVzIiwicHJvY2VlZCIsImFib3J0IiwiY29udGV4dCIsImNsaWVudCIsInByb2plY3REaXJlY3RvcnlOYW1lIiwicHJvamVjdERpcmVjdG9yeVBhdGgiLCJtYXJrZG93blN0eWxlRmlsZVBhdGhzIiwicmVhZERpcmVjdG9yeSIsImZpbGVQYXRoIiwiZmlsZVBhdGhNYXJrZG93blN0eWxlRmlsZVBhdGgiLCJpc0ZpbGVQYXRoTWFya2Rvd25TdHlsZUZpbGVQYXRoIiwibWFya2Rvd25TdHlsZUZpbGVQYXRoIiwiZmlsZVBhdGhEZWZhdWx0TWFya2Rvd25TdHlsZUZpbGVQYXRoIiwiaXNGaWxlUGF0aERlZmF1bHRNYXJrZG93blN0eWxlRmlsZVBhdGgiLCJ1bnNoaWZ0IiwicHVzaCIsImNzc1NlbGVjdG9yU3RyaW5nIiwibWFya2Rvd25TdHlsZSIsImRlZmF1bHRNYXJrZG93blN0eWxlIiwiY3NzIiwibWFya2Rvd25TdHlsZXNDU1MiLCJmb3JFYWNoIiwic2VsZWN0b3JTdHJpbmciLCJzZWxlY3RvclN0cmluZ0Zyb21NYXJrZG93blN0eWxlRmlsZVBhdGhBbmRDbGllbnQiLCJtYXJrZG93blN0eWxlRnJvbU1hcmtkb3duU3R5bGVGaWxlUGF0aCIsImNzc0Zyb21NYXJrZG93blN0eWxlQW5kU2VsZWN0b3JTdHJpbmciLCJPYmplY3QiLCJhc3NpZ24iLCJjb250ZW50IiwicmVhZEZpbGUiLCJjbGFzc05hbWUiLCJjbGFzc05hbWVGcm9tRmlsZVBhdGgiXSwibWFwcGluZ3MiOiJBQUFBOzs7OytCQWFBOzs7ZUFBd0JBOzs7OEJBWEU7Z0NBQzZCO3dCQUVqQjswQkFDRTt5QkFDRTt3QkFDOEM7QUFFeEYsSUFBUUMsQUFBMkJDLG1DQUFxQ0MseUJBQVMsQ0FBekVGLDJCQUNGLEFBQUVHLDRDQUE4Q0Msa0NBQWdCLENBQTlERDtBQUVPLFNBQVNKLDJCQUEyQk0sT0FBTyxFQUFFQyxLQUFLLEVBQUVDLE9BQU87SUFDeEUsSUFBUUMsU0FBaUNELFFBQWpDQyxRQUFRQyx1QkFBeUJGLFFBQXpCRSxzQkFDVkMsdUJBQXVCRCxzQkFDdkJFLHlCQUF5QixFQUFFO0lBRWpDQyxJQUFBQSx5QkFBYSxFQUFDRixzQkFBc0IsU0FBQ0c7UUFDbkMsSUFBTUMsZ0NBQWdDQyxJQUFBQSx5Q0FBK0IsRUFBQ0Y7UUFFdEUsSUFBSUMsK0JBQStCO1lBQ2pDLElBQU1FLHdCQUF3QkgsVUFDeEJJLHVDQUF1Q0MsSUFBQUEsZ0RBQXNDLEVBQUNMO1lBRXBGSSx1Q0FDRU4sdUJBQXVCUSxPQUFPLENBQUNILHlCQUM3QkwsdUJBQXVCUyxJQUFJLENBQUNKO1FBQ2xDO0lBQ0Y7SUFFQSxJQUFNSyxvQkFBb0JiLFNBQ0RQLG1DQUNFRCxvQ0FBeUIsRUFDOUNzQixnQkFBZ0JDLHNDQUFvQixFQUNwQ0MsTUFBTXJCLDBDQUEwQ21CLGVBQWVEO0lBRXJFLElBQUlJLG9CQUFvQkQsS0FBSyxHQUFHO0lBRWhDYix1QkFBdUJlLE9BQU8sQ0FBQyxTQUFDVjtRQUM5QixJQUFNVyxpQkFBaUJDLGlEQUFpRFosdUJBQXVCUixTQUN6RmMsZ0JBQWdCTyx1Q0FBdUNiLHdCQUN2RFEsTUFBTU0sc0NBQXNDUixlQUFlSyxnQkFBZ0JGLG9CQUFxQixHQUFHO1FBRXpHQSxvQkFBb0IsQUFBQyxHQUFzQkQsT0FBcEJDLG1CQUF3QixPQUFKRDtJQUM3QztJQUVBTyxPQUFPQyxNQUFNLENBQUN6QixTQUFTO1FBQ3JCa0IsbUJBQUFBO0lBQ0Y7SUFFQXBCO0FBQ0Y7QUFFQSxTQUFTd0IsdUNBQXVDYixxQkFBcUI7SUFDbkUsSUFBTUgsV0FBV0csdUJBQ1hpQixVQUFVQyxJQUFBQSxvQkFBUSxFQUFDckIsV0FDbkJTLGdCQUFnQlcsU0FBVSxHQUFHO0lBRW5DLE9BQU9YO0FBQ1Q7QUFFQSxTQUFTTSxpREFBaURaLHFCQUFxQixFQUFFUixNQUFNO0lBQ3JGLElBQUltQixpQkFBaUJuQixTQUNFUCxtQ0FDRUQsb0NBQXlCO0lBRWxELElBQU1hLFdBQVdHLHVCQUNYbUIsWUFBWUMsSUFBQUEsK0JBQXFCLEVBQUN2QjtJQUV4QyxJQUFJc0IsY0FBYyxNQUFNO1FBQ3RCUixpQkFBaUIsQUFBQyxHQUFvQlEsT0FBbEJSLGdCQUFlLEtBQWEsT0FBVlE7SUFDeEM7SUFFQSxPQUFPUjtBQUNUIn0=